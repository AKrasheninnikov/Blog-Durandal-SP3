/**
 * almond 0.2.0 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
* Copyright 2011-2013 (C) Spirit-EDV-Beratung AG. All rights reserved.
*/

(function(){var e,t,n;(function(i){function r(e,t){var n,i,r,o,a,s,l,c,u,d,f=t&&t.split("/"),p=w.map,v=p&&p["*"]||{};if(e&&"."===e.charAt(0)&&t){for(f=f.slice(0,f.length-1),e=f.concat(e.split("/")),c=0;e.length>c;c+=1)if(d=e[c],"."===d)e.splice(c,1),c-=1;else if(".."===d){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}if((f||v)&&p){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),f)for(u=f.length;u>0;u-=1)if(r=p[f.slice(0,u).join("/")],r&&(r=r[i])){o=r,a=c;break}if(o)break;!s&&v&&v[i]&&(s=v[i],l=c)}!o&&s&&(o=s,a=l),o&&(n.splice(0,a,o),e=n.join("/"))}return e}function o(e,t){return function(){return p.apply(i,y.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return r(t,e)}}function s(e){return function(t){m[e]=t}}function l(e){if(g.hasOwnProperty(e)){var t=g[e];delete g[e],b[e]=!0,f.apply(i,t)}if(!m.hasOwnProperty(e)&&!b.hasOwnProperty(e))throw Error("No "+e);return m[e]}function c(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(t,n,i){e.onResourceLoad&&t&&e.onResourceLoad({defined:n},{id:t},i)}function d(e){return function(){return w&&w.config&&w.config[e]||{}}}var f,p,v,h,m={},g={},w={},b={},y=[].slice;v=function(e,t){var n,i=c(e),o=i[0];return e=i[1],o&&(o=r(o,t),n=l(o)),o?e=n&&n.normalize?n.normalize(e,a(t)):r(e,t):(e=r(e,t),i=c(e),o=i[0],e=i[1],o&&(n=l(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},h={require:function(e){return o(e)},exports:function(e){var t=m[e];return t!==void 0?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:d(e)}}},f=function(e,t,n,r){var a,c,d,f,p,w,y=[];if(r=r||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,p=0;t.length>p;p+=1)if(f=v(t[p],r),c=f.f,"require"===c)y[p]=h.require(e);else if("exports"===c)y[p]=h.exports(e),w=!0;else if("module"===c)a=y[p]=h.module(e);else if(m.hasOwnProperty(c)||g.hasOwnProperty(c)||b.hasOwnProperty(c))y[p]=l(c);else{if(!f.p)throw Error(e+" missing "+c);f.p.load(f.n,o(r,!0),s(c),{}),y[p]=m[c]}d=n.apply(m[e],y),e&&(a&&a.exports!==i&&a.exports!==m[e]?m[e]=a.exports:d===i&&w||(m[e]=d))}else e&&(m[e]=n);u(e,m,y)},e=t=p=function(e,t,n,r,o){return"string"==typeof e?h[e]?h[e](t):l(v(e,t).f):(e.splice||(w=e,t.splice?(e=t,t=n,n=null):e=i),t=t||function(){},"function"==typeof n&&(n=r,r=o),r?f(i,e,t,n):setTimeout(function(){f(i,e,t,n)},15),p)},p.config=function(e){return w=e,p},n=function(e,t,n){t.splice||(n=t,t=[]),g[e]=[e,t,n]},n.amd={jQuery:!0}})(),n("durandal/amd/almond-custom",function(){}),n("config",[],function(){var e=window.sp3=window.sp3||{models:{},webs:{},dataSources:{},VERSION:"0.3.0"},t=[{url:"home",moduleId:"viewmodels/home",name:"Home",visible:!0,caption:'<i class="icon-book"></i> Home'},{url:"lists",moduleId:"sp3/PromiseDemo/index",name:"Lists",visible:!0,caption:'<i class="icon-user"></i> Lists'},{url:"lists/:id",moduleId:"sp3/ListDetail/index",name:"List Detail",visible:!1}];return{sp3:e,routes:t}}),n("main-built",function(){}),n("durandal/system",["require"],function(t){var n,i=!1,r=Object.keys,o=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=!1;if(Function.prototype.bind&&("object"==typeof console||"function"==typeof console)&&"object"==typeof console.log)try{["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]=this.call(console[e],console)},Function.prototype.bind)}catch(l){s=!0}t.on&&t.on("moduleLoaded",function(e,t){n.setModuleId(e,t)}),e!==void 0&&(e.onResourceLoad=function(e,t){n.setModuleId(e.defined[t.id],t.id)});var c=function(){},u=function(){try{if("undefined"!=typeof console&&"function"==typeof console.log)if(window.opera)for(var e=0;arguments.length>e;)console.log("Item "+(e+1)+": "+arguments[e]),e++;else 1==Array.prototype.slice.call(arguments).length&&"string"==typeof Array.prototype.slice.call(arguments)[0]?console.log(""+Array.prototype.slice.call(arguments)):console.log(Array.prototype.slice.call(arguments));else Function.prototype.bind&&!s||"undefined"==typeof console||"object"!=typeof console.log||Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))}catch(t){}};return n={version:"1.2.0",noop:c,getModuleId:function(e){return e?"function"==typeof e?e.prototype.__moduleId__:"string"==typeof e?null:e.__moduleId__:null},setModuleId:function(e,t){return e?"function"==typeof e?(e.prototype.__moduleId__=t,void 0):("string"!=typeof e&&(e.__moduleId__=t),void 0):void 0},debug:function(e){return 1!=arguments.length?i:(i=e,i?(this.log=u,this.log("Debug mode enabled.")):(this.log("Debug mode disabled."),this.log=c),void 0)},isArray:function(e){return"[object Array]"===a.call(e)},log:c,defer:function(e){return $.Deferred(e)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=0|16*Math.random(),n="x"==e?t:8|3&t;return n.toString(16)})},acquire:function(){var e=Array.prototype.slice.call(arguments,0);return this.defer(function(n){t(e,function(){var e=arguments;setTimeout(function(){n.resolve.apply(n,e)},1)})}).promise()}},n.keys=r||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)o.call(e,n)&&(t[t.length]=n);return t},n}),n("durandal/viewEngine",["./system"],function(e){var t;return t=$.parseHTML?function(e){return $.parseHTML(e)}:function(e){return $(e).get()},{viewExtension:".html",viewPlugin:"text",isViewUrl:function(e){return-1!==e.indexOf(this.viewExtension,e.length-this.viewExtension.length)},convertViewUrlToViewId:function(e){return e.substring(0,e.length-this.viewExtension.length)},convertViewIdToRequirePath:function(e){return this.viewPlugin+"!"+e+this.viewExtension},parseMarkup:function(e){var n=t(e);if(1==n.length)return n[0];for(var i=[],r=0;n.length>r;r++){var o=n[r];if(8!=o.nodeType){if(3==o.nodeType){var a=/\S/.test(o.nodeValue);if(!a)continue}i.push(o)}}return i.length>1?$(i).wrapAll('<div class="durandal-wrapper"></div>').parent().get(0):i[0]},createView:function(t){var n=this,i=this.convertViewIdToRequirePath(t);return e.defer(function(r){e.acquire(i).then(function(e){var i=n.parseMarkup(e);i.setAttribute("data-view",t),r.resolve(i)})}).promise()}}}),n("durandal/viewLocator",["./system","./viewEngine"],function(e,t){function n(e,t){for(var n=0;e.length>n;n++){var i=e[n],r=i.getAttribute("data-view");if(r==t)return i}}function i(e){return(e+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")}return{useConvention:function(e,t,n){e=e||"viewmodels",t=t||"views",n=n||t;var r=RegExp(i(e),"gi");this.convertModuleIdToViewId=function(e){return e.replace(r,t)},this.translateViewIdToArea=function(e,t){return t&&"partial"!=t?n+"/"+t+"/"+e:n+"/"+e}},locateViewForObject:function(t,n){var i;if(t.getView&&(i=t.getView()))return this.locateView(i,null,n);if(t.viewUrl)return this.locateView(t.viewUrl,null,n);var r=e.getModuleId(t);return r?this.locateView(this.convertModuleIdToViewId(r),null,n):this.locateView(this.determineFallbackViewId(t),null,n)},convertModuleIdToViewId:function(e){return e},determineFallbackViewId:function(e){var t=/function (.{1,})\(/,n=t.exec(""+e.constructor),i=n&&n.length>1?n[1]:"";return"views/"+i},translateViewIdToArea:function(e){return e},locateView:function(i,r,o){if("string"==typeof i){var a;if(a=t.isViewUrl(i)?t.convertViewUrlToViewId(i):i,r&&(a=this.translateViewIdToArea(a,r)),o){var s=n(o,a);if(s)return e.defer(function(e){e.resolve(s)}).promise()}return t.createView(a)}return e.defer(function(e){e.resolve(i)}).promise()}}}),n("durandal/viewModelBinder",["./system"],function(e){function t(t,o,a){if(!o||!t){if(n.throwOnErrors)throw Error(i);return e.log(i,o,t),void 0}if(!o.getAttribute){if(n.throwOnErrors)throw Error(r);return e.log(r,o,t),void 0}var s=o.getAttribute("data-view");try{e.log("Binding",s,t),n.beforeBind(t,o),a(),n.afterBind(t,o)}catch(l){if(n.throwOnErrors)throw Error(l.message+";\nView: "+s+";\nModuleId: "+e.getModuleId(t));e.log(l.message,s,t)}}var n,i="Insufficient Information to Bind",r="Unexpected View Type";return n={beforeBind:e.noop,afterBind:e.noop,bindContext:function(e,n,i){i&&(e=e.createChildContext(i)),t(e,n,function(){i&&i.beforeBind&&i.beforeBind(n),ko.applyBindings(e,n),i&&i.afterBind&&i.afterBind(n)})},bind:function(e,n){t(e,n,function(){e.beforeBind&&e.beforeBind(n),ko.applyBindings(e,n),e.afterBind&&e.afterBind(n)})}}}),n("durandal/viewModel",["./system"],function(e){function t(e){return void 0==e&&(e={}),e.closeOnDeactivate||(e.closeOnDeactivate=s.defaults.closeOnDeactivate),e.beforeActivate||(e.beforeActivate=s.defaults.beforeActivate),e.afterDeactivate||(e.afterDeactivate=s.defaults.afterDeactivate),e.interpretResponse||(e.interpretResponse=s.defaults.interpretResponse),e.areSameItem||(e.areSameItem=s.defaults.areSameItem),e}function n(t,n,i,r,o){if(t&&t.deactivate){e.log("Deactivating",t);var a;try{a=t.deactivate(n)}catch(s){return e.log(s),r.resolve(!1),void 0}a&&a.then?a.then(function(){i.afterDeactivate(t,n,o),r.resolve(!0)},function(t){e.log(t),r.resolve(!1)}):(i.afterDeactivate(t,n,o),r.resolve(!0))}else t&&i.afterDeactivate(t,n,o),r.resolve(!0)}function i(t,n,i,r){if(t)if(t.activate){e.log("Activating",t);var o;try{o=t.activate(r)}catch(a){return e.log(a),i(!1),void 0}o&&o.then?o.then(function(){n(t),i(!0)},function(t){e.log(t),i(!1)}):(n(t),i(!0))}else n(t),i(!0);else i(!0)}function r(t,n,i){return e.defer(function(r){if(t&&t.canDeactivate){var o;try{o=t.canDeactivate(n)}catch(a){return e.log(a),r.resolve(!1),void 0}o.then?o.then(function(e){r.resolve(i.interpretResponse(e))},function(t){e.log(t),r.resolve(!1)}):r.resolve(i.interpretResponse(o))}else r.resolve(!0)}).promise()}function o(t,n,i,r){return e.defer(function(o){if(t==n())return o.resolve(!0),void 0;if(t&&t.canActivate){var a;try{a=t.canActivate(r)}catch(s){return e.log(s),o.resolve(!1),void 0}a.then?a.then(function(e){o.resolve(i.interpretResponse(e))},function(t){e.log(t),o.resolve(!1)}):o.resolve(i.interpretResponse(a))}else o.resolve(!0)}).promise()}function a(a,s){var l=ko.observable(null);s=t(s);var c=ko.computed({read:function(){return l()},write:function(e){c.viaSetter=!0,c.activateItem(e)}});return c.settings=s,s.activator=c,c.isActivating=ko.observable(!1),c.canDeactivateItem=function(e,t){return r(e,t,s)},c.deactivateItem=function(t,i){return e.defer(function(e){c.canDeactivateItem(t,i).then(function(r){r?n(t,i,s,e,l):(c.notifySubscribers(),e.resolve(!1))})}).promise()},c.canActivateItem=function(e,t){return o(e,l,s,t)},c.activateItem=function(t,r){var o=c.viaSetter;return c.viaSetter=!1,e.defer(function(a){if(c.isActivating())return a.resolve(!1),void 0;c.isActivating(!0);var u=l();return s.areSameItem(u,t,r)?(c.isActivating(!1),a.resolve(!0),void 0):(c.canDeactivateItem(u,s.closeOnDeactivate).then(function(d){d?c.canActivateItem(t,r).then(function(d){d?e.defer(function(e){n(u,s.closeOnDeactivate,s,e)}).promise().then(function(){t=s.beforeActivate(t,r),i(t,l,function(e){c.isActivating(!1),a.resolve(e)},r)}):(o&&c.notifySubscribers(),c.isActivating(!1),a.resolve(!1))}):(o&&c.notifySubscribers(),c.isActivating(!1),a.resolve(!1))}),void 0)}).promise()},c.canActivate=function(){var e;return a?(e=a,a=!1):e=c(),c.canActivateItem(e)},c.activate=function(){var e;return a?(e=a,a=!1):e=c(),c.activateItem(e)},c.canDeactivate=function(e){return c.canDeactivateItem(c(),e)},c.deactivate=function(e){return c.deactivateItem(c(),e)},c.includeIn=function(e){e.canActivate=function(){return c.canActivate()},e.activate=function(){return c.activate()},e.canDeactivate=function(e){return c.canDeactivate(e)},e.deactivate=function(e){return c.deactivate(e)}},s.includeIn?c.includeIn(s.includeIn):a&&c.activate(),c.forItems=function(t){s.closeOnDeactivate=!1,s.determineNextItemToActivate=function(e,t){var n=t-1;return-1==n&&e.length>1?e[1]:n>-1&&e.length-1>n?e[n]:null},s.beforeActivate=function(e){var n=c();if(e){var i=t.indexOf(e);-1==i?t.push(e):e=t()[i]}else e=s.determineNextItemToActivate(t,n?t.indexOf(n):0);return e},s.afterDeactivate=function(e,n){n&&t.remove(e)};var n=c.canDeactivate;c.canDeactivate=function(i){return i?e.defer(function(e){function n(){for(var t=0;o.length>t;t++)if(!o[t])return e.resolve(!1),void 0;e.resolve(!0)}for(var r=t(),o=[],a=0;r.length>a;a++)c.canDeactivateItem(r[a],i).then(function(e){o.push(e),o.length==r.length&&n()})}).promise():n()};var i=c.deactivate;return c.deactivate=function(n){return n?e.defer(function(e){function i(i){c.deactivateItem(i,n).then(function(){o++,t.remove(i),o==a&&e.resolve()})}for(var r=t(),o=0,a=r.length,s=0;a>s;s++)i(r[s])}).promise():i()},c},c}var s;return s={defaults:{closeOnDeactivate:!0,interpretResponse:function(e){if("string"==typeof e){var t=e.toLowerCase();return"yes"==t||"ok"==t}return e},areSameItem:function(e,t){return e==t},beforeActivate:function(e){return e},afterDeactivate:function(e,t,n){t&&n&&n(null)}},activator:a}}),n("durandal/composition",["./viewLocator","./viewModelBinder","./viewEngine","./system","./viewModel"],function(e,t,n,i,r){function o(e){return e.model&&e.model.activate&&(f.activateDuringComposition&&void 0==e.activate||e.activate)}function a(e,t){o(e)?r.activator().activateItem(e.model).then(function(e){e&&t()}):t()}function s(e){for(var t=[],n={childElements:t,activeView:null},i=ko.virtualElements.firstChild(e);i;)1==i.nodeType&&(t.push(i),i.getAttribute(d)&&(n.activeView=i)),i=ko.virtualElements.nextSibling(i);return n}function l(e,t,n){n.activeView&&n.activeView.removeAttribute(d),t&&(n.model&&n.model.viewAttached&&(n.composingNewView||n.alwaysAttachView)&&n.model.viewAttached(t),t.setAttribute(d,!0)),n.afterCompose&&n.afterCompose(e,t,n)}function c(e,t){if("string"==typeof t.transition){if(t.activeView){if(t.activeView==e)return!1;if(!e)return!0;if(t.skipTransitionOnSameViewId){var n=t.activeView.getAttribute("data-view"),i=e.getAttribute("data-view");return n!=i}}return!0}return!1}var u={},d="data-active-view",f={activateDuringComposition:!1,convertTransitionToModuleId:function(e){return"durandal/transitions/"+e},switchContent:function(e,t,n){if(n.transition=n.transition||this.defaultTransitionName,c(t,n)){var r=this.convertTransitionToModuleId(n.transition);i.acquire(r).then(function(i){n.transition=i,i(e,t,n).then(function(){l(e,t,n)})})}else t!=n.activeView&&(n.cacheViews&&n.activeView&&$(n.activeView).css("display","none"),t?n.cacheViews?n.composingNewView?(n.viewElements.push(t),ko.virtualElements.prepend(e,t)):$(t).css("display",""):(ko.virtualElements.emptyNode(e),ko.virtualElements.prepend(e,t)):n.cacheViews||ko.virtualElements.emptyNode(e)),l(e,t,n)},bindAndShow:function(e,i,r){r.composingNewView=r.cacheViews?-1==ko.utils.arrayIndexOf(r.viewElements,i):!0,a(r,function(){if(r.beforeBind&&r.beforeBind(e,i,r),r.preserveContext&&r.bindingContext)r.composingNewView&&t.bindContext(r.bindingContext,i,r.model);else if(i){var o=r.model||u,a=ko.dataFor(i);if(a!=o){if(!r.composingNewView)return $(i).remove(),n.createView(i.getAttribute("data-view")).then(function(t){f.bindAndShow(e,t,r)}),void 0;t.bind(o,i)}}f.switchContent(e,i,r)})},defaultStrategy:function(t){return e.locateViewForObject(t.model,t.viewElements)},getSettings:function(e){var t=ko.utils.unwrapObservable(e())||{};if("string"==typeof t)return t;var n=i.getModuleId(t);if(n)return{model:t};for(var r in t)t[r]=ko.utils.unwrapObservable(t[r]);return t},executeStrategy:function(e,t){t.strategy(t).then(function(n){f.bindAndShow(e,n,t)})},inject:function(t,n){return n.model?n.view?(e.locateView(n.view,n.area,n.viewElements).then(function(e){f.bindAndShow(t,e,n)}),void 0):((void 0===n.view||n.view)&&(n.strategy||(n.strategy=this.defaultStrategy),"string"==typeof n.strategy?i.acquire(n.strategy).then(function(e){n.strategy=e,f.executeStrategy(t,n)}):this.executeStrategy(t,n)),void 0):(this.bindAndShow(t,null,n),void 0)},compose:function(t,r,o){"string"==typeof r&&(r=n.isViewUrl(r)?{view:r}:{model:r});var a=i.getModuleId(r);a&&(r={model:r});var l=s(t);r.bindingContext=o,r.activeView=l.activeView,r.cacheViews&&!r.viewElements&&(r.viewElements=l.childElements),r.model?"string"==typeof r.model?i.acquire(r.model).then(function(e){r.model="function"==typeof e?new e(t,r):e,f.inject(t,r)}):f.inject(t,r):r.view?(r.area=r.area||"partial",r.preserveContext=!0,e.locateView(r.view,r.area,r.viewElements).then(function(e){f.bindAndShow(t,e,r)})):this.bindAndShow(t,null,r)}};return ko.bindingHandlers.compose={update:function(e,t,n,i,r){var o=f.getSettings(t);f.compose(e,o,r)}},ko.virtualElements.allowedBindings.compose=!0,f}),n("durandal/widget",["./system","./composition"],function(e,t){var n="data-part",i="["+n+"]",r={},o={},a=["model","view","kind"],s={getParts:function(t){var r={};e.isArray(t)||(t=[t]);for(var o=0;t.length>o;o++){var a=t[o];if(a.getAttribute){var s=a.getAttribute(n);s&&(r[s]=a);for(var l=$(i,a),c=0;l.length>c;c++){var u=l.get(c);r[u.getAttribute(n)]=u}}}return r},getSettings:function(e){var t=ko.utils.unwrapObservable(e())||{};if("string"==typeof t)return t;for(var n in t)t[n]=-1!=ko.utils.arrayIndexOf(a,n)?ko.utils.unwrapObservable(t[n]):t[n];return t},registerKind:function(e){ko.bindingHandlers[e]={init:function(){return{controlsDescendantBindings:!0}},update:function(t,n,i,r,o){var a=s.getSettings(n);a.kind=e,s.create(t,a,o)}},ko.virtualElements.allowedBindings[e]=!0},mapKind:function(e,t,n){t&&(o[e]=t),n&&(r[e]=n)},convertKindToModuleId:function(e){return r[e]||"durandal/widgets/"+e+"/controller"},convertKindToViewId:function(e){return o[e]||"durandal/widgets/"+e+"/view"},beforeBind:function(e,t){var n=s.getParts(e),i=s.getParts(t);for(var r in n)$(i[r]).replaceWith(n[r])},createCompositionSettings:function(e){return e.model||(e.model=this.convertKindToModuleId(e.kind)),e.view||(e.view=this.convertKindToViewId(e.kind)),e.preserveContext=!0,e.beforeBind=this.beforeBind,e},create:function(e,n,i){"string"==typeof n&&(n={kind:n});var r=s.createCompositionSettings(n);t.compose(e,r,i)}};return ko.bindingHandlers.widget={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t,n,i,r){var o=s.getSettings(t);s.create(e,o,r)}},ko.virtualElements.allowedBindings.widget=!0,s}),n("durandal/modalDialog",["./composition","./system","./viewModel"],function(e,t,n){function i(e){return t.defer(function(n){"string"==typeof e?t.acquire(e).then(function(e){"function"==typeof e?n.resolve(new e):n.resolve(e)}):n.resolve(e)}).promise()}var r={},o=0,a={currentZIndex:1050,getNextZIndex:function(){return++this.currentZIndex},isModalOpen:function(){return o>0},getContext:function(e){return r[e||"default"]},addContext:function(e,t){t.name=e,r[e]=t;var n="show"+e.substr(0,1).toUpperCase()+e.substr(1);this[n]=function(t,n){return this.show(t,n,e)}},createCompositionSettings:function(e,t){var n={model:e,activate:!1};return t.afterCompose&&(n.afterCompose=t.afterCompose),n},show:function(a,s,l){var c=this,u=r[l||"default"];return t.defer(function(t){i(a).then(function(i){var r=n.activator();r.activateItem(i,s).then(function(n){if(n){var a=i.modal={owner:i,context:u,activator:r,close:function(){var e=arguments;r.deactivateItem(i,!0).then(function(n){n&&(o--,u.removeHost(a),delete i.modal,t.resolve.apply(t,e))})}};a.settings=c.createCompositionSettings(i,u),u.addHost(a),o++,e.compose(a.host,a.settings)}else t.resolve(!1)})})}).promise()}};return a.addContext("default",{blockoutOpacity:.2,removeDelay:200,addHost:function(e){var t=$("body"),n=$('<div class="modalBlockout"></div>').css({"z-index":a.getNextZIndex(),opacity:this.blockoutOpacity}).appendTo(t),i=$('<div class="modalHost"></div>').css({"z-index":a.getNextZIndex()}).appendTo(t);if(e.host=i.get(0),e.blockout=n.get(0),!a.isModalOpen()){e.oldBodyMarginRight=$("body").css("margin-right");var r=$("html"),o=t.outerWidth(!0),s=r.scrollTop();$("html").css("overflow-y","hidden");var l=$("body").outerWidth(!0);t.css("margin-right",l-o+parseInt(e.oldBodyMarginRight)+"px"),r.scrollTop(s),$("#simplemodal-overlay").css("width",l+"px")}},removeHost:function(e){if($(e.host).css("opacity",0),$(e.blockout).css("opacity",0),setTimeout(function(){$(e.host).remove(),$(e.blockout).remove()},this.removeDelay),!a.isModalOpen()){var t=$("html"),n=t.scrollTop();t.css("overflow-y","").scrollTop(n),$("body").css("margin-right",e.oldBodyMarginRight)}},afterCompose:function(e,t,n){var i=$(t),r=i.width(),o=i.height();i.css({"margin-top":""+-o/2+"px","margin-left":""+-r/2+"px"}),$(n.model.modal.host).css("opacity",1),$(t).hasClass("autoclose")&&$(n.model.modal.blockout).click(function(){n.model.modal.close()}),$(".autofocus",t).each(function(){$(this).focus()})}}),a}),n("durandal/events",["./system"],function(e){var t=/\s+/,n=function(){},i=function(e,t){this.owner=e,this.events=t};return i.prototype.then=function(e,t){return this.callback=e||this.callback,this.context=t||this.context,this.callback?(this.owner.on(this.events,this.callback,this.context),this):this},i.prototype.on=i.prototype.then,i.prototype.off=function(){return this.owner.off(this.events,this.callback,this.context),this},n.prototype.on=function(e,n,r){var o,a,s;if(n){for(o=this.callbacks||(this.callbacks={}),e=e.split(t);a=e.shift();)s=o[a]||(o[a]=[]),s.push(n,r);return this}return new i(this,e)},n.prototype.off=function(n,i,r){var o,a,s,l;if(!(a=this.callbacks))return this;if(!(n||i||r))return delete this.callbacks,this;for(n=n?n.split(t):e.keys(a);o=n.shift();)if((s=a[o])&&(i||r))for(l=s.length-2;l>=0;l-=2)i&&s[l]!==i||r&&s[l+1]!==r||s.splice(l,2);else delete a[o];return this},n.prototype.trigger=function(e){var n,i,r,o,a,s,l,c;if(!(i=this.callbacks))return this;for(c=[],e=e.split(t),o=1,a=arguments.length;a>o;o++)c[o-1]=arguments[o];for(;n=e.shift();){if((l=i.all)&&(l=l.slice()),(r=i[n])&&(r=r.slice()),r)for(o=0,a=r.length;a>o;o+=2)r[o].apply(r[o+1]||this,c);if(l)for(s=[n].concat(c),o=0,a=l.length;a>o;o+=2)l[o].apply(l[o+1]||this,s)}return this},n.prototype.proxy=function(e){var t=this;return function(n){t.trigger(e,n)}},n.includeIn=function(e){e.on=n.prototype.on,e.off=n.prototype.off,e.trigger=n.prototype.trigger,e.proxy=n.prototype.proxy},n}),n("durandal/app",["./system","./viewEngine","./composition","./widget","./modalDialog","./events"],function(e,t,n,i,r,o){var a={title:"Application",showModal:function(e,t,n){return r.show(e,t,n)},showMessage:function(e,t,n){return r.show("./messageBox",{message:e,title:t||this.title,options:n})},start:function(){var t=this;return t.title&&(document.title=t.title),e.defer(function(t){$(function(){e.log("Starting Application"),t.resolve(),e.log("Started Application")})}).promise()},setRoot:function(e,i,r){var o,a={activate:!0,transition:i};o=r&&"string"!=typeof r?r:document.getElementById(r||"applicationHost"),"string"==typeof e?t.isViewUrl(e)?a.view=e:a.model=e:a.model=e,n.compose(o,a)},adaptToDevice:function(){document.ontouchmove=function(e){e.preventDefault()}}};return o.includeIn(a),a}),n("durandal/plugins/router",["../system","../viewModel","../app"],function(e,t,n){function i(t){S(!1),e.log("Redirecting"),g.navigateTo(t)}function r(){A=!0,e.log("Cancelling Navigation"),w&&m.setLocation(w),A=!1,S(!1);var t=m.last_location[1].split("#/")[1];w||!t?M():t!=y?window.location.replace("#/"+y):M()}function o(e,t,n){$(e),g.onNavigationComplete(e,t,n),b=n,w=m.last_location[1].replace("/",""),M()}function a(t,n,i){e.log("Activating Route",t,i,n),L.activateItem(i,n).then(function(e){e?o(t,n,i):r()})}function s(){return A||m.last_location[1].replace("/","")==w}function l(e,t,n){var o=g.guardRoute(e,t,n);o?o.then?o.then(function(o){o?"string"==typeof o?i(o):a(e,t,n):r()}):"string"==typeof o?i(o):a(e,t,n):r()}function c(){if(!S()){var t=N.shift();N=[],t&&(S(!0),e.acquire(t.routeInfo.moduleId).then(function(e){t.params.routeInfo=t.routeInfo,t.params.router=g;var n=g.getActivatableInstance(t.routeInfo,t.params,e);g.guardRoute?l(t.routeInfo,t.params,n):a(t.routeInfo,t.params,n)}))}}function u(e,t){N.unshift({routeInfo:e,params:t}),c()}function d(e,t){var n=I[e];if(!s()){if(!n){if(!g.autoConvertRouteToModuleId)return g.handleInvalidRoute(e,t),void 0;var i=g.convertRouteToName(e);n={moduleId:g.autoConvertRouteToModuleId(e,t),name:i,caption:i}}u(n,t)}}function f(){d(y,this.params||{})}function p(){d(""+this.app.last_route.path,this.params||{})}function v(){var e,t=this.params||{};if(g.autoConvertRouteToModuleId){var n=this.path.split("#/");if(2==n.length){var i=n[1].split("/");return e=i[0],t.splat=i.splice(1),d(e,t),void 0}}g.handleInvalidRoute(this.app.last_location[1],t)}function h(e){return g.prepareRouteInfo(e),I[""+e.url]=e,k.push(e),e.visible&&(e.isActive=ko.computed(function(){return C()&&L()&&L().__moduleId__==e.moduleId}),T.push(e)),e}var m,g,w,b,y,x,I={},k=ko.observableArray([]),T=ko.observableArray([]),C=ko.observable(!1),S=ko.observable(!1),A=!1,L=t.activator(),$=ko.observable(),N=[],M=function(){M=e.noop,C(!0),g.dfd.resolve(),delete g.dfd};return L.settings.areSameItem=function(){return!1},g={ready:C,allRoutes:k,visibleRoutes:T,isNavigating:S,activeItem:L,activeRoute:$,afterCompose:function(){setTimeout(function(){S(!1),c()},10)},getActivatableInstance:function(e,t,n){return"function"==typeof n?new n:n},useConvention:function(e){e=null==e?"viewmodels":e,e&&(e+="/"),g.convertRouteToModuleId=function(t){return e+g.stripParameter(t)}},stripParameter:function(e){var t=e.indexOf(":"),n=t>0?t-1:e.length;return e.substring(0,n)},handleInvalidRoute:function(t,n){e.log("No Route Found",t,n)},onNavigationComplete:function(e){document.title=n.title?e.name+" | "+n.title:e.name},navigateBack:function(){window.history.back()},navigateTo:function(e,t){switch(t=t||"trigger",t.toLowerCase()){case"skip":x=e,m.setLocation(e);break;case"replace":window.location.replace(e);break;default:m.lookupRoute("get",e)?m.setLocation(e):window.location.href=e}},replaceLocation:function(e){this.navigateTo(e,"replace")},convertRouteToName:function(e){var t=g.stripParameter(e);return t.substring(0,1).toUpperCase()+t.substring(1)},convertRouteToModuleId:function(e){return g.stripParameter(e)},prepareRouteInfo:function(e){e.url instanceof RegExp||(e.name=e.name||g.convertRouteToName(e.url),e.moduleId=e.moduleId||g.convertRouteToModuleId(e.url),e.hash=e.hash||"#/"+e.url),e.caption=e.caption||e.name,e.settings=e.settings||{}},mapAuto:function(e){e=e||"viewmodels",e+="/",g.autoConvertRouteToModuleId=function(t){return e+g.stripParameter(t)}},mapNav:function(e,t,n){return"string"==typeof e?this.mapRoute(e,t,n,!0):(e.visible=!0,h(e))},mapRoute:function(e,t,n,i){return"string"==typeof e?h({url:e,moduleId:t,name:n,visible:i}):h(e)},map:function(t){if(!e.isArray(t))return h(t);for(var n=[],i=0;t.length>i;i++)n.push(h(t[i]));return n},activate:function(t){return e.defer(function(n){var i;g.dfd=n,y=t,m=Sammy(function(e){for(var t=k(),n=0;t.length>n;n++){var r=t[n];e.get(r.url,p),i=this.routes.get[n],I[""+i.path]=r}e.get("#/",f),e.get(/\#\/(.*)/,v)}),m._checkFormSubmission=function(){return!1},m.before(null,function(e){if(x){if(e.path==="/"+x)return x=null,!1;throw Error("Expected to skip url '"+x+"', but found url '"+e.path+"'")}return!0}),m.log=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("Sammy"),e.log.apply(e,t)},m.run("#/")}).promise()}}}),n("services/logger",["durandal/system"],function(e){function t(e,t,n,i){o(e,t,n,i,"info")}function n(e,t,n,i){o(e,t,n,i,"error")}function i(e,t,n,i){o(e,t,n,i,"success")}function r(e,t,n,i){o(e,t,n,i,"warning")}function o(t,n,i,r,o){i=i?"["+i+"]":"",n?e.log(t,i,n):e.log(t,i),r&&($.inArray(o,["error","success","warning"])>-1?toastr[o](t):toastr.info(t))}var a={log:t,logError:n,logSuccess:i,logWarning:r};return a}),t.config({paths:{text:"durandal/amd/text"}}),n("main",["durandal/app","durandal/viewLocator","durandal/system","durandal/plugins/router","services/logger"],function(e,t,n,i,r){e.start().then(function(){toastr.options.positionClass="toast-bottom-right",toastr.options.backgroundpositionClass="toast-bottom-right",i.handleInvalidRoute=function(e){r.logError("No Route Found",e,"main",!0)},i.useConvention({views:"."}),t.useConvention(),e.adaptToDevice(),e.setRoot("viewmodels/shell","entrance")})}),n("durandal/http",[],function(){return{defaultJSONPCallbackParam:"callback",get:function(e,t){return $.ajax(e,{data:t})},jsonp:function(e,t,n){return-1==e.indexOf("=?")&&(n=n||this.defaultJSONPCallbackParam,e+=-1==e.indexOf("?")?"?":"&",e+=n+"=?"),$.ajax({url:e,dataType:"jsonp",data:t})},post:function(e,t){return $.ajax({url:e,data:ko.toJSON(t),type:"POST",contentType:"application/json",dataType:"json"})}}}),n("text",["module"],function(e){var n,i,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,s="undefined"!=typeof location&&location.href,l=s&&location.protocol&&location.protocol.replace(/\:/,""),c=s&&location.hostname,u=s&&(location.port||void 0),d=[],f=e.config&&e.config()||{};return n={version:"2.0.3",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),i=e.substring(0,n),r=e.substring(n+1,e.length);return n=r.indexOf("!"),-1!==n&&(t=r.substring(n+1,r.length),t="strip"===t,r=r.substring(0,n)),{moduleName:i,ext:r,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,i,r){var o,a,s,l=n.xdRegExp.exec(e);return l?(o=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==t||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==r)):!0},finishLoad:function(e,t,i,r){i=t?n.strip(i):i,f.isBuild&&(d[e]=i),r(i)},load:function(e,t,i,r){if(r.isBuild&&!r.inlineText)return i(),void 0;f.isBuild=r.isBuild;var o=n.parseName(e),a=o.moduleName+"."+o.ext,d=t.toUrl(a),p=f.useXhr||n.useXhr;!s||p(d,l,c,u)?n.get(d,function(t){n.finishLoad(e,o.strip,t,i)},function(e){i.error&&i.error(e)}):t([a],function(e){n.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,t,i){if(d.hasOwnProperty(t)){var r=n.jsEscape(d[t]);i.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,i,r,o){var a=n.parseName(t),s=a.moduleName+"."+a.ext,l=i.toUrl(a.moduleName+"."+a.ext)+".js";n.load(s,i,function(){var t=function(e){return r(l,e)};t.asModule=function(e,t){return r.asModule(e,l,t)},n.write(e,s,t,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(i=t.nodeRequire("fs"),n.get=function(e,t){var n=i.readFileSync(e,"utf8");0===n.indexOf("﻿")&&(n=n.substring(1)),t(n)}):"xhr"===f.env||!f.env&&n.createXhr()?n.get=function(e,t,i){var r=n.createXhr();r.open("GET",e,!0),f.onXhr&&f.onXhr(r,e),r.onreadystatechange=function(){var n,o;4===r.readyState&&(n=r.status,n>399&&600>n?(o=Error(e+" HTTP status: "+n),o.xhr=r,i(o)):t(r.responseText))},r.send(null)}:("rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(n.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),l="";try{for(n=new java.lang.StringBuffer,i=s.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),n.append(i);null!==(i=s.readLine());)n.append(a),n.append(i);l=""+n+""}finally{s.close()}t(l)}),n}),n("text!durandal/messageBox.html",[],function(){return'<div class="messageBox">\r\n    <div class="modal-header">\r\n        <h3 data-bind="html: title"></h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <p class="message" data-bind="html: message"></p>\r\n    </div>\r\n    <div class="modal-footer" data-bind="foreach: options">\r\n        <button class="btn" data-bind="click: function () { $parent.selectOption($data); }, html: $data, css: { \'btn-primary\': $index() == 0, autofocus: $index() == 0 }"></button>\r\n    </div>\r\n</div>'
}),n("durandal/messageBox",[],function(){var e=function(t,n,i){this.message=t,this.title=n||e.defaultTitle,this.options=i||e.defaultOptions};return e.prototype.selectOption=function(e){this.modal.close(e)},e.prototype.activate=function(t){t&&(this.message=t.message,this.title=t.title||e.defaultTitle,this.options=t.options||e.defaultOptions)},e.defaultTitle="Application",e.defaultOptions=["Ok"],e}),n("durandal/transitions/entrance",["../system"],function(e){var t=100,n=function(n,i,r){return e.defer(function(e){function o(){e.resolve()}function a(){r.keepScrollPosition||$(document).scrollTop(0)}function s(){a(),r.cacheViews?r.composingNewView&&ko.virtualElements.prepend(n,i):(ko.virtualElements.emptyNode(n),ko.virtualElements.prepend(n,i));var e={marginLeft:u?"0":"20px",marginRight:u?"0":"-20px",opacity:0,display:"block"},t={marginRight:0,marginLeft:0,opacity:1};$(i).css(e),$(i).animate(t,c,"swing",o)}if(i){var l=$(r.activeView),c=r.duration||500,u=!!r.fadeOnly;l.length?l.fadeOut(t,s):s()}else a(),r.activeView?$(r.activeView).fadeOut(t,function(){r.cacheViews||ko.virtualElements.emptyNode(n),o()}):(r.cacheViews||ko.virtualElements.emptyNode(n),o())}).promise()};return n}),n("durandal/widgets/expander/controller",["durandal/widget"],function(e){var t=function(e,t){this.settings=t};return t.prototype.getHeaderText=function(e){return this.settings.headerProperty?e[this.settings.headerProperty]:""+e},t.prototype.afterRenderItem=function(t){var n=e.getParts(t),i=$(n.itemContainer);i.hide(),$(n.headerContainer).bind("click",function(){i.toggle("fast")})},t}),n("text!durandal/widgets/expander/view.html",[],function(){return'<div class="accordion" data-bind="foreach: { data: settings.items, afterRender: afterRenderItem }">\r\n  <div class="accordion-group">\r\n    <div class="accordion-heading">\r\n      <a data-part="headerContainer" href="#" class="accordion-toggle">\r\n        <div data-part="header" data-bind="html: $parent.getHeaderText($data)"></div>\r\n      </a>\r\n    </div>\r\n    <div class="accordion-body collapse in">\r\n      <div class="accordion-inner" data-part="itemContainer" >\r\n        <div data-part="item" data-bind="compose: $data"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>'}),n("services/formatter",[],function(){function e(e){return e.userName}function t(e){return"function"==typeof e.format?e.format("F"):void 0}function n(e){return"function"==typeof e.format?e.format(this.args||"F"):void 0}function i(e){return e.substring(e.indexOf(";#")+2)}var r={userName:e,fileName:i,dateLong:t,date:n};return r}),n("services/spdata",["./logger"],function(e){function t(e){var t=[],n=e.viewFields||["Title"];return t.push("<ViewFields>"),$.each(n,function(e,n){t.push('<FieldRef Name="'),t.push(n),t.push('" />')}),t.push("</ViewFields>"),t.join("")}function n(e){var t=[];return t.push("<Query>"),e.sortExpression.length>0&&(t.push("<OrderBy>"),$.each(e.sortExpression,function(e,n){sortDir="asc"===n.dir(),t.push('<FieldRef Name="'+n.field()+'" Ascending="'+sortDir+'"/>')}),t.push("</OrderBy>")),t.push("</Query>"),t.join("")}function i(e){var t="",n=[];return n.push("<QueryOptions>"),n.push("<DateInUtc>False</DateInUtc>"),n.push("<ExpandUserField>True</ExpandUserField>"),1===e.baseType&&n.push('<ViewAttributes Scope="Recursive" />'),e.page>1&&(t=e.pagingHistory[e.page-1].replace(/&/g,"&amp;")),n.push('<Paging ListItemCollectionPositionNext="'+t+'"/>'),n.push("</QueryOptions>"),n.join("")}function r(e){var t={};return $(e).SPFilterNode("List").each(function(e,n){for(var i,r={},o=0;n.attributes.length>o;o++){var a=n.attributes[o];a.specified&&("Title"===a.name&&(i=a.value.toLowerCase()),r[a.name]="false"===a.value.toLowerCase()?!1:"true"===a.value.toLowerCase()?!0:a.value)}i=(r.WebFullUrl+"/"+i).toLowerCase(),t[i]=r}),t}function o(e,t){var n,i={},r=i.SPXmlToJsonMap={};return t=t||{fields:{FilterNode:"Field",PropertyID:"StaticName"},info:{FilterNode:"List",PropertyID:!1}},$.each(t,function(t,n){var r=i[t]={};$(e).SPFilterNode(n.FilterNode).each(function(e,o){for(var a,s={},l=0;o.attributes.length>l;l++){var c=o.attributes[l];c.specified&&(c.name===n.PropertyID&&(a=c.value,r[a]={}),s[c.name]="false"===c.value.toLowerCase()?!1:"true"===c.value.toLowerCase()?!0:c.value)}n.PropertyID&&a?r[a]=s:n.PropertyID||(i[t]=s)})}),n=(i.info.WebFullUrl+"/"+i.info.Title).toLowerCase(),sp3.models[n]=i,$.each(i.fields,function(e,t){r["ows_"+e]={mappedName:e,objectType:t.Type}}),i}var a=function(t){if(sp3.webs[t.webUrl])return e.log("cached ListCollection",sp3.webs[t.webUrl],"spdata.getListCollection()",!0),sp3.webs[t.webUrl];var n=$().SPServices({operation:"GetListCollection",webURL:t.webUrl});return $.when(n).then(function(n){return e.logSuccess("resolve getListCollectionPromise",r(n),"spdata.getListCollection",!0),sp3.webs[t.webUrl]=r(n),sp3.webs[t.webUrl]}).fail(function(t){e.logError("Error",t,"spdata.getListCollection()",!0)})},s=function(t){if(sp3.models[t.key])return e.log("cached model",sp3.models[t.key],"spdata.getModel()",!0),sp3.models[t.key];var n=$().SPServices({operation:"GetList",listName:t.listName,webURL:t.webUrl});return $.when(n).then(function(t){return e.logSuccess("resolve getListPromise",o(t),"spdata.getModel()",!0),o(t)}).fail(function(t){e.logError("Error",t,"spdata.getModel()",!0)})},l=function(t,n){var i=$().SPServices(t);return n=n||{},$.when(i).then(function(t){var i=$(t),r={ItemCount:parseInt(i.SPFilterNode("rs:data").attr("ItemCount"),10)||0,ListItemCollectionPositionNext:i.SPFilterNode("rs:data").attr("ListItemCollectionPositionNext")||"",data:i.SPFilterNode("z:row").SPXmlToJson({mapping:n,includeAllAttrs:!0,removeOws:!1})};return e.logSuccess("resolve getListItemsPromise",r,"spdata.getListItems()",!0),r}).fail(function(t){e.logError("Error",t,"spdata.getListItems()",!0)})},c=function(e){var r=i({page:e.page(),pagingHistory:e.pagingHistory,baseType:parseInt(e.baseType,10)}),o=n({sortExpression:e._sort()}),a=t({viewFields:e.viewFields});return{operation:"GetListItems",async:!1,webURL:e.webUrl,listName:e.listName,CAMLQuery:o,CAMLRowLimit:e._pageSize(),CAMLViewFields:a,CAMLQueryOptions:r}};return{getListCollection:a,getListItems:l,getListItemsOptions:c,getModel:s}}),n("text!sp3/ListDetail/grid.html",[],function(){return'<div>\r\n <table class="table table-striped table-bordered table-hover">\r\n  <colgroup data-bind="foreach: columns">\r\n    <col data-bind="attr: { style: getColStyle() }" />\r\n  </colgroup>\r\n\r\n  <thead>\r\n    <tr data-bind="foreach: columns">\r\n      <th data-bind="click: $root.sortByHeader, css: { sortable: sortable }">\r\n        <span data-bind="text: title"></span>\r\n        <!-- ko if: sorted()-->\r\n        <!-- ko if: sortAsc()-->\r\n        <i class="icon-angle-up pull-right"></i>\r\n        <!-- /ko -->\r\n        <!-- ko if: !sortAsc()-->\r\n        <i class="icon-angle-down pull-right"></i>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n      </th>\r\n    </tr>\r\n  </thead>\r\n\r\n  <tbody data-bind="foreach: listItems">\r\n    <tr data-bind="foreach: $parent.columns, css: { odd: $index() % 2 === 0 }">\r\n\r\n      <!-- ko ifnot: $data.template -->\r\n      <td data-bind="text: $parent[$data.field]"></td>\r\n      <!-- /ko -->\r\n\r\n      <!-- ko if: $data.template -->\r\n      <td data-bind="text: $data.template($parent[$data.field])"></td>\r\n      <!-- /ko -->\r\n\r\n    </tr>\r\n  </tbody>\r\n\r\n  <tbody data-bind="if: paging().isEmpty">\r\n    <tr>\r\n      <td data-bind="attr: { colspan: columns.length }">The query returned no results</td>\r\n    </tr>\r\n  </tbody>\r\n\r\n  <tfoot>\r\n    <tr>\r\n      <td data-bind="attr: { colspan: columns.length }">\r\n        <table class="footer">\r\n          <tbody>\r\n            <tr>\r\n              <td class="pageSize">\r\n                <div class="pull-left">\r\n                  <span class="loader" data-bind="css: { active: isFetching }">\r\n                    <i class="icon-spinner icon-2x icon-spin"></i>\r\n                  </span>\r\n                </div>\r\n\r\n                <select class="span1" data-bind="value: _pageSize, options: [3, 5, 7, 10, 13, 17, 20, 50]"></select>\r\n                <!--<input class="span1" data-bind="value: _pageSize"></input>-->\r\n                <span class="help-inline">items</span>\r\n\r\n              </td>\r\n              <td class="pager">\r\n                <a href="#" data-bind="css: { disabled: !hasPrevious() }, click: previous"><i class="icon-angle-left"></i>previous</a>\r\n                <a href="#" data-bind="css: { disabled: !hasNext() }, click: next">next <i class="icon-angle-right"></i></a>\r\n              </td>\r\n              <td class="pageInfo">\r\n                <span class="" data-bind="text: paging().from"></span>- <span class="" data-bind="  text: paging().to"></span>\r\n                <div class="pull-right">\r\n                  <a href="#" title="Settings. Not implemented!" onclick="return false;">\r\n                    <i class="icon-cog"></i>\r\n                  </a>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </td>\r\n    </tr>\r\n  </tfoot>\r\n\r\n\r\n</table>\r\n\r\n</div>\r\n'}),n("sp3/ListDetail/gridConfig",["services/formatter"],function(e){var t={107:[{field:"ID",title:"ID",width:80},{field:"Title",title:"Title",width:"20%"},{field:"Status",title:"Status",width:"15%"},{field:"Priority",title:"Priority",width:"15%"},{field:"Modified",title:"Modified",template:e.date,args:"yyyy/MM/dd HH:mm"},{field:"Editor",title:"Editor",width:"20%",template:e.userName}]},n={0:[{field:"ID",title:"ID",width:80},{field:"Title",title:"Title",width:"15%"},{field:"Modified",title:"Modified",template:e.date},{field:"Editor",title:"Editor",template:e.userName}],1:[{field:"ID",title:"ID",width:80},{field:"FileLeafRef",title:"Name",template:e.fileName},{field:"Modified",title:"Modified"},{field:"Editor",title:"Editor",template:e.userName}],3:[{field:"ID",title:"ID",width:80},{field:"Title",title:"Title",width:"15%"},{field:"Modified",title:"Modified"},{field:"Editor",title:"Editor",width:"20%",template:e.userName}],4:[{field:"ID",title:"ID",width:80},{field:"Title",title:"Title",width:"15%"},{field:"Modified",title:"Modified"},{field:"Editor",title:"Editor",width:"20%",template:e.userName}],5:[{field:"ID",title:"ID",width:80},{field:"Title",title:"Title",width:"15%"},{field:"Modified",title:"Modified"},{field:"Editor",title:"Editor",width:"20%",template:e.userName}]};return{pageSize:10,sort:[{field:"ID",dir:"asc"}],viewFields:["Title"],columnsPerBaseType:n,columnsPerServerTemplate:t}}),n("sp3/ListDetail/grid",["services/spdata","services/logger","./gridConfig"],function(e,t,n){var i=function(e){e=e||{},this.field=ko.observable(e.field||"ID"),this.dir=ko.observable(e.dir||"asc")},r=function(e){var t=this,n={sortable:!0,width:null};return e=e||{},this.sorted=ko.observable(!1),this.sortAsc=ko.observable(!1),this.init=function(){$.each(["field","title","width","template","sortable","args"],function(i,r){(e[r]||n[r])&&(t[r]=e[r]||n[r])})},this.getColStyle=function(){var e;return"number"==typeof t.width?e=t.width+"px":"string"==typeof t.width&&(t.width.indexOf("px")>-1||t.width.indexOf("%")>-1)&&(e=t.width),e?"width:"+e:""},this.init(),t},o=function(e){var n=this;return e?(this.model=e,this.pagingHistory=[""],this.viewFields=[],this.ListItemCollectionPositionNext=ko.observable(""),this.listItems=ko.observableArray([]),this.isFetching=ko.observable(!1),this.page=ko.observable(1),this.itemCount=ko.observable(0),this._sort=ko.observableArray([]),this._pageSize=ko.observable(),this.hasPrevious=ko.computed(function(){return n.page()>1}),this.hasNext=ko.computed(function(){return""!==n.ListItemCollectionPositionNext()}),this.paging=ko.computed(function(){var e=1,t=0,i=!n.hasNext()&&!n.hasPrevious()&&0===n.itemCount();return i?(e=0,t=0):(e=(n.page()-1)*n._pageSize()+1,t=n.page()*n._pageSize(),n.hasNext()||(t=e+n.itemCount()-1)),{page:n.page(),itemCount:n.itemCount(),from:e,to:t,hasNext:n.hasNext(),hasPrevious:n.hasPrevious(),isEmpty:i}}),this.sortByHeader=function(){var e="asc";this.field===n._sort()[0].field()&&(e="asc"===n._sort()[0].dir()?"desc":"asc"),this.sorted(!0),this.sortAsc("asc"===e),n.sort({field:this.field,dir:e})},this.init(this.model),void 0):(t.logError("Invalid model",this,"grid.js",!0),void 0)};return o.prototype.init=function(e){var t=this,i=[];e=e||{},this.webUrl=e.webUrl||L_Menu_BaseUrl,this.listName=e.listName||"",this.baseType=parseInt(e.listInfo.info.BaseType,10),this.serverTemplate=parseInt(e.listInfo.info.ServerTemplate,10),this._pageSize(e.pageSize||n.pageSize),this.columns=e.columns?e.columns:n.columnsPerServerTemplate[this.serverTemplate]||n.columnsPerBaseType[this.baseType],$.each(this.columns,function(e,n){i.push(n.field),t.columns[e]=new r(n)}),this.viewFields=$.unique((e.viewFields||n.viewFields).concat(i)),$.each(["_pageSize","_sort"],function(e,n){t[n].subscribe(function(){t.refresh()})}),this.sort(e.sort||n.sort),sp3.dataSources[this.key()]=this},o.prototype.refresh=function(){this.pagingHistory=[""],this.page(1),this.fetch()},o.prototype.key=function(){var e=this.webUrl.replace(/^\/+|\/+$/g,"");return"/"+e.toLowerCase()+"/"+this.listName.toLowerCase()},o.prototype.fetch=function(){var t=this;t.isFetching(!0),e.getListItems(e.getListItemsOptions(this),this.model.listInfo.SPXmlToJsonMap).then(function(e){t.listItems(e.data),t.ListItemCollectionPositionNext(e.ListItemCollectionPositionNext),t.itemCount(e.ItemCount),t.pagingHistory.push(e.ListItemCollectionPositionNext),t.isFetching(!1)})},o.prototype.next=function(){return""===this.ListItemCollectionPositionNext()?!1:(this.page(this.page()+1),this.fetch(),void 0)},o.prototype.previous=function(){var e=0;return 3>this.pagingHistory.length?!1:(this.page(this.page()-1),e=this.page()-this.pagingHistory.length,this.pagingHistory.splice(e),this.fetch(),void 0)},o.prototype.sort=function(e){function t(){$.each(r.columns,function(e,t){t.sorted(!1),t.sortAsc(!1)})}function n(e){$.grep(r.columns,function(t){t.field===e.field&&(t.sorted(!0),t.sortAsc("asc"===e.dir))})}var r=this,o=[];return e?(e=$.isArray(e)?e:[e],t(),$.each(e,function(e,t){var a=new i(t);n(t),$.each(["field","dir"],function(e,t){a[t].subscribe(function(){r.sort(ko.toJS(r._sort))})}),o.push(a)}),this._sort(o),void 0):ko.toJSON(r._sort)},o}),n("text!sp3/ListDetail/index.html",[],function(){return'<div>\r\n <h2 data-bind="text: listName"></h2>\r\n\r\n  <div id="grid" data-bind="compose: Grid">\r\n  </div>\r\n</div>\r\n'}),n("sp3/ListDetail/index",["services/spdata","./grid"],function(e,t){var n=function(e){this.options=e||{},this.fields=[],this.init(e)};return n.prototype.init=function(e){e||(e={}),this.webUrl=e.webUrl||L_Menu_BaseUrl,this.listName=e.listName||""},n.prototype.key=function(){var e=this.webUrl.replace(/^\/+|\/+$/g,"");return"/"+e.toLowerCase()+"/"+this.listName.toLowerCase()},n.prototype.activate=function(n){n&&n.id&&(this.listName=n.id);var i=this,r={listName:this.listName,webUrl:this.webUrl,key:this.key()};return $.when(e.getModel(r)).then(function(e){i.listInfo=e,$.each(e.fields,function(e,t){if(!t.Hidden){if(t.Sortable===void 0)return i.fields.push(t),void 0;if(t.Sortable)return i.fields.push(t),void 0}}),i.Grid=new t(i)})},n.prototype.deactivate=function(){delete sp3.dataSources[this.key()]},n}),n("text!sp3/PromiseDemo/index.html",[],function(){return'<div>\r\n\r\n  <div class="row-fluid">\r\n    <div class="pull-right">\r\n      <label>Change number of columns</label>\r\n      <select data-bind="options: [1, 2, 3, 4, 6, 12], value: columnLength"></select>\r\n     </div>\r\n  </div>\r\n\r\n  <!--ko foreach: rows-->\r\n  <div class="row-fluid show-grid" data-bind="foreach: $data">\r\n    \r\n    <div class="list-brief" title="Go to list details" data-bind="css: $root.colClass()">\r\n      <h3 data-bind="text: $data._listInfo.Title"></h3>\r\n\r\n      <span class="pull-left" data-bind="text: $data._listInfo.Modified"></span>\r\n      <span class="badge pull-right" data-bind="text: $data._listInfo.ItemCount, css: $root.counterClass()"></span>\r\n        \r\n    </div>\r\n\r\n  </div>\r\n  <!--/ko-->\r\n \r\n</div>\r\n'}),n("sp3/PromiseDemo/index",["durandal/viewModel","durandal/plugins/router","services/logger","services/spdata"],function(e,t,n,i){function r(e){var t=[];return $.each(e,function(e,n){n.Hidden||t.push({webUrl:n.WebFullUrl,listName:n.Title,_listInfo:n})}),t}var o=ko.observable(),a=ko.observableArray([]),s=ko.observable(3),l=function(){var e=this,t=L_Menu_BaseUrl;return e.webUrl(t),n.log("Activatíng List View",null,"list",!0),$.when(i.getListCollection({webUrl:t})).then(function(t){return e.listInfo=t,e.lists(r(t)),!0})},c=function(e){if(e){var n="#/lists/"+e.listName;t.navigateTo(n)}},u=function(e){d(e,".list-brief",c)},d=function(e,t,n,i){var r=i||"click";$(e).on(r,t,function(){var e=ko.dataFor(this);return n(e),!1})},f={title:"Promises demo",webUrl:o,lists:a,activate:l,viewAttached:u,activeList:e.activator().forItems(a),columnLength:s};return f.rows=ko.computed(function(){for(var e,t=[],n=parseInt(this.columnLength(),10),i=0,r=this.lists().length;r>i;i++)0===i%n&&(e&&t.push(e),e=[]),e.push(this.lists()[i]);return e&&t.push(e),t},f),f.colClass=ko.computed(function(){var e=12,t=parseInt(this.columnLength(),10);return 0===e%t?"span"+e/t:"alert-error"},f),f.counterClass=function(){var e=["","","","","success","warning","important","info","inverse"],t=e[Math.ceil(Math.random()*e.length)-1];return""!==t?"badge-"+t:""},f}),n("viewmodels/home",["services/logger"],function(e){function t(){return e.log("Activating Home View",null,"home",!0),!0}var n={activate:t,title:"Home View"};return n}),n("viewmodels/shell",["durandal/system","durandal/plugins/router","services/logger","config"],function(e,t,n,i){function r(){return o()}function o(){return t.map(i.routes),t.activate("home")}var a={activate:r,router:t};return a}),n("text!views/home.html",[],function(){return'<div>\r\n  <h2 class="page-title" data-bind="text: title"></h2>\r\n  <p>\r\n    This page is intentionally left blank. Click on the "Lists" link to see something usefull.\r\n  </p>\r\n\r\n  <h3>Read more</h3>\r\n  <ul>\r\n    <li>\r\n      <a href="http://rainerat.spirit.de/2013/04/08/durandal-sp3-developing-sharepoint-spas-made-easy/">http://rainerat.spirit.de/2013/04/08/durandal-sp3-developing-sharepoint-spas-made-easy/</a>\r\n    </li>\r\n    <li>\r\n      <a href="http://sympmarc.com/2013/04/15/spservices-stories-13-durandal-sp3-developing-sharepoint-spas-made-easy/">http://sympmarc.com/2013/04/15/spservices-stories-13-durandal-sp3-developing-sharepoint-spas-made-easy/</a>\r\n    </li>\r\n  </ul>\r\n  <p>Last update: 2013/04/16</p>\r\n</div>\r\n'}),n("text!views/nav.html",[],function(){return'<div class="navbar navbar">\r\n  <div class="navbar-inner">\r\n    <a class="brand" data-bind="attr: { href: router.visibleRoutes()[0].hash }">\r\n      <i class="icon-home"></i>\r\n      <span>Durandal SP3</span>\r\n    </a>\r\n    <ul class="nav" data-bind="foreach: router.visibleRoutes">\r\n      <li data-bind="css: { active: isActive }">\r\n        <a data-bind="attr: { href: hash },\r\n                      html: caption"></a>\r\n      </li>\r\n    </ul>\r\n    <div class="loader pull-right" data-bind="css: { active: router.isNavigating }">\r\n      <i class="icon-spinner icon-2x icon-spin"></i>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n'}),n("text!views/shell.html",[],function(){return"<div>\r\n    <div>\r\n        <!--ko compose: {view: 'nav'} --><!--/ko-->\r\n    </div>\r\n     <div id=\"content\" class=\"main container-fluid\">\r\n        <!--ko compose: {model: router.activeItem, \r\n            afterCompose: router.afterCompose, \r\n            transition: 'entrance'} -->\r\n        <!--/ko-->\r\n    </div>\r\n</div>\r\n"}),t(["main"])})();